<style>
  /* Basic styles for highlighting */
  .speech-line {
    display: block;
    margin-bottom: 10px;
    transition: background 0.3s;
    padding: 2px 5px;
  }
  .highlight {
    background-color: #ffff99; /* yellow highlight */
  }
</style>

<div id="voiceTextContainer">
  <span class="speech-line">Want to ace your Nursing exams?</span>
  <span class="speech-line">The Nursing Prometric Test is a simulation exam for Nurse Technicians and Nurse Specialists.</span>
  <span class="speech-line">It contains</span>
  <span class="speech-line">500</span>
  <span class="speech-line">questions based on the SMLE and Enclex exams, divided into Easy, Medium, and Hard levels.</span>
  <span class="speech-line">Each question comes with a detailed rationale to help you understand, learn, and improve your score.</span>
  <span class="speech-line">Take the demo test for</span>
  <span class="speech-line">free</span>
  <span class="speech-line">and unlock the full test with a secure code today!</span>
</div>

<script>
window.addEventListener('DOMContentLoaded', () => {
  const lines = document.querySelectorAll('#voiceTextContainer .speech-line');

  const messages = [
    { text: "Want to ace your Nursing exams?", pitch: 1.2, rate: 1 },
    { text: "The Nursing Prometric Test is a simulation exam for Nurse Technicians and Nurse Specialists.", pitch: 1, rate: 1 },
    { text: "It contains", pitch: 1.1, rate: 1.1 },
    { text: "500", pitch: 1.5, rate: 0.9 },
    { text: "questions based on the SMLE and Enclex exams, divided into Easy, Medium, and Hard levels.", pitch: 1.1, rate: 1.1 },
    { text: "Each question comes with a detailed rationale to help you understand, learn, and improve your score.", pitch: 1, rate: 1 },
    { text: "Take the demo test for", pitch: 1.2, rate: 1.1 },
    { text: "free", pitch: 1.5, rate: 0.9 },
    { text: "and unlock the full test with a secure code today!", pitch: 1.2, rate: 1.1 }
  ];

  function speakMessages() {
    const voices = window.speechSynthesis.getVoices();
    const voice = voices.find(v => v.lang === 'en-US' && v.name.includes('Google')) || voices[0];

    let totalDelay = 0;

    messages.forEach((msg, index) => {
      setTimeout(() => {
        // Highlight the current line
        lines.forEach(line => line.classList.remove('highlight'));
        lines[index].classList.add('highlight');

        const utterance = new SpeechSynthesisUtterance(msg.text);
        utterance.voice = voice;
        utterance.lang = 'en-US';
        utterance.pitch = msg.pitch;
        utterance.rate = msg.rate;
        utterance.volume = 1;
        window.speechSynthesis.speak(utterance);
      }, totalDelay);

      totalDelay += (msg.text.split(" ").length / 10) * 500 + 300; // dynamic delay
    });

    // Remove highlight after last line
    setTimeout(() => {
      lines.forEach(line => line.classList.remove('highlight'));
    }, totalDelay + 500);
  }

  if (speechSynthesis.onvoiceschanged !== undefined) {
    speechSynthesis.onvoiceschanged = speakMessages;
  } else {
    speakMessages();
  }
});
</script>
