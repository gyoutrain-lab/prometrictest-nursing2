<style>
  #voiceTextContainer {
    max-width: 700px;
    margin: 20px auto;
    font-size: 20px;
    line-height: 1.6;
    overflow: hidden;
    position: relative;
  }
  .speech-line {
    display: block;
    margin-bottom: 10px;
  }
  .highlight {
    background-color: #ffff99;
    transition: background 0.2s;
  }
  .word {
    transition: background 0.1s;
  }
</style>

<div id="voiceTextContainer">
  <span class="speech-line" data-text="Want to ace your Nursing exams?"></span>
  <span class="speech-line" data-text="The Nursing Prometric Test is a simulation exam for Nurse Technicians and Nurse Specialists."></span>
  <span class="speech-line" data-text="It contains"></span>
  <span class="speech-line" data-text="500"></span>
  <span class="speech-line" data-text="questions based on the SMLE and Enclex exams, divided into Easy, Medium, and Hard levels."></span>
  <span class="speech-line" data-text="Each question comes with a detailed rationale to help you understand, learn, and improve your score."></span>
  <span class="speech-line" data-text="Take the demo test for"></span>
  <span class="speech-line" data-text="free"></span>
  <span class="speech-line" data-text="and unlock the full test with a secure code today!"></span>
</div>

<script>
window.addEventListener('DOMContentLoaded', () => {
  const container = document.getElementById('voiceTextContainer');
  const lines = Array.from(container.querySelectorAll('.speech-line'));

  // Split text into word spans for highlighting
  lines.forEach(line => {
    const text = line.dataset.text;
    line.innerHTML = '';
    text.split(' ').forEach(word => {
      const span = document.createElement('span');
      span.className = 'word';
      span.textContent = word + ' ';
      line.appendChild(span);
    });
  });

  const messages = [
    { text: "Want to ace your Nursing exams?", pitch: 1.2, rate: 1 },
    { text: "The Nursing Prometric Test is a simulation exam for Nurse Technicians and Nurse Specialists.", pitch: 1, rate: 1 },
    { text: "It contains", pitch: 1.1, rate: 1.1 },
    { text: "500", pitch: 1.5, rate: 0.9 },
    { text: "questions based on the SMLE and Enclex exams, divided into Easy, Medium, and Hard levels.", pitch: 1.1, rate: 1.1 },
    { text: "Each question comes with a detailed rationale to help you understand, learn, and improve your score.", pitch: 1, rate: 1 },
    { text: "Take the demo test for", pitch: 1.2, rate: 1.1 },
    { text: "free", pitch: 1.5, rate: 0.9 },
    { text: "and unlock the full test with a secure code today!", pitch: 1.2, rate: 1.1 }
  ];

  function speakWordByWord() {
    const voices = window.speechSynthesis.getVoices();
    const voice = voices.find(v => v.lang === 'en-US' && v.name.includes('Google')) || voices[0];

    let delay = 0;

    lines.forEach((line, i) => {
      const words = Array.from(line.querySelectorAll('.word'));
      let wordDelay = 0;

      words.forEach((word, wIdx) => {
        setTimeout(() => {
          // Scroll container smoothly
          const lineTop = line.offsetTop;
          container.scrollTo({ top: lineTop - 20, behavior: 'smooth' });

          // Highlight current word
          words.forEach(w => w.classList.remove('highlight'));
          word.classList.add('highlight');

          // Speak the word
          const utter = new SpeechSynthesisUtterance(word.textContent.trim());
          utter.voice = voice;
          utter.lang = 'en-US';
          // Small variations to pitch/rate for emphasis words
          if(word.textContent.trim() === "500" || word.textContent.trim() === "free") {
            utter.pitch = 1.5;
            utter.rate = 0.9;
          } else {
            utter.pitch = messages[i].pitch;
            utter.rate = messages[i].rate;
          }
          utter.volume = 1;
          window.speechSynthesis.speak(utter);

        }, delay + wordDelay);

        // Estimate delay per word (~0.35s)
        wordDelay += 350;
      });

      // Add delay after line for next line
      delay += words.length * 350 + 200;
    });
  }

  if (speechSynthesis.onvoiceschanged !== undefined) {
    speechSynthesis.onvoiceschanged = speakWordByWord;
  } else {
    speakWordByWord();
  }
});
</script>
